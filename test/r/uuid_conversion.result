INSTALL EXTENSION vsql_uuid;
#
# Test UUID binary conversion functions
#
SET @test_uuid = '550e8400-e29b-41d4-a716-446655440000';
SET @binary_uuid = vsql_uuid.uuid_to_binary(@test_uuid);
SELECT vsql_uuid.binary_to_uuid(@binary_uuid) = @test_uuid AS roundtrip_success;
roundtrip_success
1
SET @uuid1 = '6ba7b810-9dad-11d1-80b4-00c04fd430c8';
SET @uuid2 = 'f47ac10b-58cc-4372-a567-0e02b2c3d479';
SET @uuid3 = '00000000-0000-0000-0000-000000000000';
SET @uuid4 = 'ffffffff-ffff-ffff-ffff-ffffffffffff';
SELECT vsql_uuid.binary_to_uuid(vsql_uuid.uuid_to_binary(@uuid1)) = @uuid1 AS test1_roundtrip;
test1_roundtrip
1
SELECT vsql_uuid.binary_to_uuid(vsql_uuid.uuid_to_binary(@uuid2)) = @uuid2 AS test2_roundtrip;
test2_roundtrip
1
SELECT vsql_uuid.binary_to_uuid(vsql_uuid.uuid_to_binary(@uuid3)) = @uuid3 AS test3_roundtrip;
test3_roundtrip
1
SELECT vsql_uuid.binary_to_uuid(vsql_uuid.uuid_to_binary(@uuid4)) = @uuid4 AS test4_roundtrip;
test4_roundtrip
1
SET @upper_uuid = '550E8400-E29B-41D4-A716-446655440000';
SET @lower_uuid = '550e8400-e29b-41d4-a716-446655440000';
SELECT vsql_uuid.uuid_to_binary(@upper_uuid) = vsql_uuid.uuid_to_binary(@lower_uuid) AS case_insensitive;
case_insensitive
1
SELECT LOWER(vsql_uuid.binary_to_uuid(vsql_uuid.uuid_to_binary(@upper_uuid))) = @lower_uuid AS output_lowercase;
output_lowercase
1
SELECT vsql_uuid.uuid_to_binary('invalid-uuid') IS NULL AS invalid_to_binary;
invalid_to_binary
0
SELECT vsql_uuid.uuid_to_binary('') IS NULL AS empty_to_binary;
empty_to_binary
0
SELECT vsql_uuid.uuid_to_binary(NULL) IS NULL AS null_to_binary;
null_to_binary
1
SELECT vsql_uuid.binary_to_uuid('invalid') IS NULL AS invalid_from_binary;
ERROR HY000: Incorrect uuid value: 'invalid'
SELECT vsql_uuid.binary_to_uuid('') IS NULL AS empty_from_binary;
ERROR HY000: Incorrect uuid value: ''
SELECT vsql_uuid.binary_to_uuid(NULL) IS NULL AS null_from_binary;
ERROR HY000: Cannot initialize function 'binary_to_uuid': argument 1 must be a custom type or string constant
SELECT vsql_uuid.binary_to_uuid('tooshort') IS NULL AS short_binary;
ERROR HY000: Incorrect uuid value: 'tooshort'
SELECT vsql_uuid.binary_to_uuid('thisistoolongtobeauuid') IS NULL AS long_binary;
ERROR HY000: Incorrect uuid value: 'thisistoolongtobeauuid'
SET @binary_uuid = NULL;
UNINSTALL EXTENSION vsql_uuid;
